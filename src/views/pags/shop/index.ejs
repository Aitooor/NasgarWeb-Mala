<% 

function categoryDisplay(category, name) {
  name = name || category.name;
  return category.display.replace(/\{\{NAME\}\}/g, name);
}

%> 

<!DOCTYPE html>
<html lang="es">
<head>
	<%- include("../../partials/header.ejs") %> 
	<title> Tienda - Nasgar Network </title>

	<%- include("../../partials/less.ejs", { paths: ["pags/shop/index"] }) %> 

	<script src="/js/pg/shop/index.js" type="module"></script>
</head>
<body>
	<%- include("../../partials/nav_modern.ejs", { global, tab: "shop", solid: true, transparent_height: 3 }) %>
	
	<div class="body centered">
		<aside>
			<div class="categories">
				<% for(const category of categories) { %>
					<% if (category.subcategories?.length > 0) { %>
						<div class="category">
              <a href="/shop/category/<%- category.uuid %>" class="category-header">
                <%- categoryDisplay(category, global.lang.menu.shop[category.name] || category.name) %>
              </a>

              <div class="category-content">
                <% for(const subcategory of category.subcategories) { %>
                  <a href="/shop/category/<%- subcategory.uuid %>" class="subcategory" >
                    <%- categoryDisplay(subcategory, global.lang.menu.shop[subcategory.name] || subcategory.name) %>
                  </a>
                <% } %>
              </div>
            </div>
					<% } else { %>
            <a href="/shop/category/<%= category.uuid %>" class="category"><%- categoryDisplay(category, global.lang.menu.shop[category.name] || category.name) %></a>
          <% } %>
        <% } %>
			</div>
		</aside>
		<div class="mainbox">
			<main>
				<div class="title">
					<%- categoryDisplay(category) %>
				</div>
				<div class="info-text">
					<%- category.description %>
				</div>
        <% if (category.subcategories?.length > 0) { %>
          <div class="subcategories">
            <% for(const subcategory of category.subcategories) { %>
              <a href="/shop/category/<%- subcategory.uuid %>" class="btn subcategory" >
                <%- categoryDisplay(subcategory, global.lang.menu.shop[subcategory.name] || subcategory.name) %>
              </a>
            <% } %>
          </div>
        <% } %>
				<div class="products">
					<% products.forEach((product, id) => { %> 
						<div class="product" title="<%= product.name %>" data-product-id="<%= product.uuid %>" data-commons-onclick="link, /shop/product/<%= product.uuid %> ">
							<div class="img"><img src="/img/<%= (product.img ?? "defaultKey.png") %> "></div>
							<div class="product-name"><%= product.name %></div>
							<div class="footer">
								<div class="product-price"><%= product.price %></div>
								<button type="submit" class="add-basket primary hover-anim-ball">
									<span>Add to basket</span>
								</button>
							</div>
						</div>
					<% }) %> 
				</div>
			</main>
		</div>
	</div>

	<div class="toasts"></div>
</body>
</html>
